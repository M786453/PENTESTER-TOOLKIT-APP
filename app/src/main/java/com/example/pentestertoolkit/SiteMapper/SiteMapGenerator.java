package com.example.pentestertoolkit.SiteMapper;

import android.os.AsyncTask;
import android.util.Log;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

import java.util.ArrayList;

public class SiteMapGenerator extends AsyncTask<Void, Void, Void> {

    private String site_url;

    public SiteMapGenerator(String site_url){

        this.site_url = site_url;

    }


    @Override
    protected Void doInBackground(Void... voids) {

        generateSiteMap();

        return null;
    }

    private ArrayList<String> generateSiteMap(){

        ArrayList<String> links_list = new ArrayList<>();

        try{

            Document site_doc = Jsoup.connect(site_url).get();

            Elements link_elements = site_doc.select("a[href]");

            for (Element link: link_elements){

                String href = link.attr("href");

                Log.i("LINK: ", href);

                if (!href.startsWith("#") && !href.startsWith("mailto:") && !href.startsWith("tel:")){
                    links_list.add(href);
                }

            }


        }catch (Exception e){
            e.printStackTrace();
        }
        return links_list;
    }


}
