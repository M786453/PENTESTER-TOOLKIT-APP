package com.example.pentestertoolkit.SiteMapper;

import androidx.annotation.Nullable;
import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.webkit.WebResourceRequest;
import android.webkit.WebResourceResponse;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.widget.Button;
import android.widget.EditText;

import com.example.pentestertoolkit.Global.HttpData;
import com.example.pentestertoolkit.R;

public class SmBrowser extends AppCompatActivity {

    private WebView browser;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_sm_browser);

        //hide actionbar
        getSupportActionBar().hide();

        //Initialize UI components
        browser = findViewById(R.id.hm_webview);

        // Configuring browser
        browser.getSettings().setJavaScriptEnabled(true);
        browser.getSettings().setLoadsImagesAutomatically(true);
        browser.getSettings().setSupportZoom(true);

        // Browse target url
        String url = getIntent().getStringExtra("URL");
        browser.loadUrl(url);

        // Browser Client
        browser.setWebViewClient(new WebViewClient(){
            @Override
            public boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request) {
                String url = request.getUrl().toString();
                view.loadUrl(url);
                return true;
            }

            @Nullable
            @Override
            public WebResourceResponse shouldInterceptRequest(WebView view, WebResourceRequest request) {

                String link = request.getUrl().toString();

                if (link.contains("http://") || link.contains("https://"))
                    link = link.split("://")[1];

                if (link.contains("www"))
                    link = link.split("www.")[1];

                Log.i("SM_REQUEST: ", link);

                HttpData.linkClassifier.addLink(link);

                return super.shouldInterceptRequest(view, request);
            }




        });










    }
}