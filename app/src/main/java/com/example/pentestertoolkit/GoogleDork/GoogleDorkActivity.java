package com.example.pentestertoolkit.GoogleDork;

import androidx.appcompat.app.AppCompatActivity;

import android.app.ProgressDialog;
import android.media.Image;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageView;
import android.widget.ListView;

import com.example.pentestertoolkit.R;

import java.io.BufferedReader;
import java.io.Console;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.ArrayList;
import java.util.HashMap;

public class GoogleDorkActivity extends AppCompatActivity implements GoogleDorker.GoogleDorkerCallback {

    private ListView dork_results_listview;

    private ProgressDialog progressDialog;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_google_dork);

        getSupportActionBar().hide();

        // Initialize UI Components
        EditText edtSearchQuery = findViewById(R.id.edt_google_dork_query);
        ImageView imgSettings = findViewById(R.id.img_settings_google_dork);
        dork_results_listview = findViewById(R.id.scraped_links_listview);

        progressDialog = new ProgressDialog(this);
        progressDialog.setMessage("Searching...");


        imgSettings.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                progressDialog.show();
                GoogleDorker googleDorker = new GoogleDorker(GoogleDorkActivity.this, edtSearchQuery.getText().toString());
                googleDorker.execute();
            }
        });

    }

    @Override
    public void onGoogleDorkResult(ArrayList<String> scraped_links) {
        ArrayAdapter<String> scraped_links_adapter = new ArrayAdapter<>(GoogleDorkActivity.this, R.layout.listview_item_google_dork,R.id.txtGoogleDork, scraped_links);
        dork_results_listview.setAdapter(scraped_links_adapter);
        progressDialog.dismiss();
    }
}