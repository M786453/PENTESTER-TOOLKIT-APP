package com.example.pentestertoolkit.HttpMonitor;

import androidx.annotation.Nullable;
import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.webkit.WebResourceRequest;
import android.webkit.WebResourceResponse;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.widget.Button;
import android.widget.EditText;

import com.example.pentestertoolkit.R;

public class HmBrowser extends AppCompatActivity {

    private EditText edt_url;
    private Button btn_browse;
    private WebView browser;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_hm_monitor_browser);

        //hide actionbar
        getSupportActionBar().hide();

        //Initialize UI components
        edt_url = findViewById(R.id.edt_hm_browser);
        btn_browse = findViewById(R.id.btnHmBrowser);
        browser = findViewById(R.id.hm_webview);

        // Configuring browser
        browser.getSettings().setJavaScriptEnabled(true);
        browser.getSettings().setLoadsImagesAutomatically(true);

        // Load target Url
        btn_browse.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                String url = edt_url.getText().toString();
                browser.loadUrl(url);
            }
        });

        // Browser Client

        browser.setWebViewClient(new WebViewClient(){
            @Override
            public boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request) {
                String url = request.getUrl().toString();
                view.loadUrl(url);
                return true;
            }

            @Nullable
            @Override
            public WebResourceResponse shouldInterceptRequest(WebView view, WebResourceRequest request) {
                Log.i("HM_REQUEST: ", request.getUrl().toString());
                ReqResData.requestsData.add(request);
                return super.shouldInterceptRequest(view, request);
            }
        });




    }
}